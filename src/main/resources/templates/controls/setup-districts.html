<!DOCTYPE html>
<html
	th:replace="~{layout/controls :: layout(_,~{},~{::scripts},~{::content},~{})}">

<content>
<div
	class="col-md-12 py-3 my-3 mx-auto p-5 rounded box-shadow table-responsive"
	style="background-color: #92c7f2;">
	<form action="#"
		th:action="@{/controls/district/{id}(id=${selected.region_uuid})}"
		th:object="${selected}" method="POST" class="needs-validation"
		novalidate>
		<div th:if="${success}" class="alert alert-success"
			th:text="${success}"></div>

		<input th:field="*{country}" hidden=true /> <input
			th:field="*{region_uuid}" hidden=true /> <input
			th:field="*{region_name}" hidden=true />

		<div>
			<a class="btn btn-sm btn-dark"
				th:href="@{/controls/region/{id}(id=${selected.country.country_uuid})}"
				th:utext="#{back.button}"></a>
		</div>

		<table class="table">
			<thead>
				<tr>
					<th th:text="#{th.setup_country}"></th>
					<th th:text="#{th.setup_region}"></th>
					<th th:text="#{th.setup_district}"></th>
					<th th:text="#{th.setup_facility}"></th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="item, itemStat : *{districtList}">
					<td>[[${item.region.country.country_name}]] <input
						th:field="*{districtList[__${itemStat.index}__].region}"
						hidden=true readonly />
					</td>
					<td>[[${item.region.region_name}]] <input hidden=true readonly
						th:field="*{districtList[__${itemStat.index}__].district_uuid}" /></td>
					<td><input type="text" class="form-control form-control-sm"
						th:field="*{districtList[__${itemStat.index}__].district_name}"
						required /><span th:unless="${item.district_name}"><a
							class="text-danger" th:if="${add}"
							th:href="@{/controls/district/{id}(id=${selected.region_uuid})}"
							th:text="#{cancel.button}"></a></span></td>
					<td><a th:if="${item.district_name}"
						class="btn btn-info btn-sm"
						th:href="@{/controls/facility/{id}(id=${item.district_uuid})}">
							[[#{th.facilities.link}]] <span class="badge bg-primary">
								[[${#lists.size(item.facilityList)}]]</span>
					</a></td>
				</tr>
				<tr th:unless="${add}">
					<td></td>
					<td></td>
					<td><a class="btn btn-sm btn-success small"
						th:href="@{/controls/district/{id}?add=1(id=${selected.region_uuid})}"
						th:text="#{add.button}"></a></td>
					<td></td>
				</tr>
			</tbody>
		</table>
		<div class="mb-4" th:if="${selected.region_uuid}">
			<button class="btn btn-primary" type="submit"
				th:utext="#{save.button}"></button>
		</div>

	</form>
</div>
</content>

<scripts> <script>
	(function() {
		'use strict';
		window.addEventListener('load', function() {
			// Fetch all the forms we want to apply custom Bootstrap validation styles to
			var forms = document.getElementsByClassName('needs-validation');

			// Loop over them and prevent submission
			var validation = Array.prototype.filter.call(forms, function(form) {
				form.addEventListener('submit', function(event) {
					if (form.checkValidity() === false) {
						event.preventDefault();
						event.stopPropagation();
					}
					form.classList.add('was-validated');

				}, false);
			});
		}, false);
	})();
</script> </scripts>

</html>